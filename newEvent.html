<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="./dependencies/bootstrap.min.css">
	<script src='./dependencies/moment.min.js'></script>
	<script type="text/javascript" src="./dependencies/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="./dependencies/jquery-ui.min.js"></script>
	<link rel='stylesheet' href='./dependencies/jquery-ui.min.css' />
	<script type="text/javascript" src="./dependencies/bootstrap.min.js"></script>
	<link rel='stylesheet' href='./dependencies/fullcalendar.css' />
	<script src='./dependencies/fullcalendar.js'></script>
	<link rel="stylesheet" href="./dependencies/bootstrap-datetimepicker.min.css">
	<script type="text/javascript" src="./dependencies/bootstrap-datetimepicker.min.js"></script>
	<link rel="stylesheet" href="weboss.css">

	<title>WeBoss Agenda</title>

	<link rel="apple-touch-icon" sizes="180x180" href="./favicons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="./favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="./favicons/favicon-16x16.png">
	<link rel="manifest" href="./favicons/manifest.json">
	<link rel="mask-icon" href="./favicons/safari-pinned-tab.svg" color="#5bbad5">
	<meta name="theme-color" content="#ffffff">
</head>
<body>
	<div class="row" style="height:90%">
		<div class="col-xs-12 col-md-12">
			<a href="./menu.html"><h2 class="title">WeBoss</h2></a>
		</div>
		<container class="col-xs-8 col-xs-offset-2 col-sm-offset-4 col-sm-6 col-md-6 col-md-offset-3 col-lg-4 col-lg-offset-4 agenda-form">
			<div class="form-inline ">
				<input type="text" class="form-control we-button agenda" name="title" id="title" placeholder="Title" onfocus="this.placeholder = ''"/>
				<input type="text" class="form-control we-button agenda" name="event" id="event" placeholder="Address" onfocus="this.placeholder = ''"/>
			 	<div class='input-group date agenda' id='datetimepicker1'>
                    <input type='text' class="form-control we-button" placeholder="Starting Time" />
                    <span class="input-group-addon gradient">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                </div>
                <div class='input-group date agenda' id='datetimepicker2'>
                    <input type='text' class="form-control we-button" placeholder="Finishing Time" />
                    <span class="input-group-addon gradient">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                </div>
                <script type="text/javascript">
				    $(function () {
				        $('#datetimepicker1').datetimepicker();
				        $('#datetimepicker2').datetimepicker();

				    });
				</script>
				<button class="btn btn-primary btn-block gradient" id="add">Ajouter</button>
			</div> 
		</container>
	</div>
	<div class="row">
		<div class="col-xs-12 loader-div">
				<div class="loader-container">
				<div class="rectangle-1"></div>
				<div class="rectangle-2"></div>
				<div class="rectangle-3"></div>
				<div class="rectangle-4"></div>
				<div class="rectangle-5"></div>
				<div class="rectangle-6"></div>
				<div class="rectangle-5"></div>
				<div class="rectangle-4"></div>
				<div class="rectangle-3"></div>
				<div class="rectangle-2"></div>
				<div class="rectangle-1"></div>
			</div>	
		</div>
	</div>
</body>
</html>

<script>	
$(document).ready(function() {
	var location = null;
	var autocomplete = null;

    // page is now ready, initialize the calendar...

    //$('#datetimepicker1').datepicker();

    $('#calendar').fullCalendar({
		defaultView: 'basicWeek',
		editable: false
    })

    updateCalendar();

    /*var event={id:1 , title: 'Julien', start:  new Date()};

	$('#calendar').fullCalendar('renderEvent', event, true);*/

	$('#add').click(function(){
		var startDate = $("#datetimepicker1").data("DateTimePicker").date();
		var finishDate = $("#datetimepicker2").data("DateTimePicker").date();

		if (startDate !== null) { 
			var event={id:Date.now() ,title: $('#title').val(), start: startDate, location: location};	
		}
		if (finishDate !== null) {
			var finishEvent={id:Date.now() ,title: $('#title').val(), start: finishDate, location: location};
		}
		var events = JSON.parse(localStorage.getItem('events'));
		console.log(events);
		if (events == null){
			events = [];
		}
		if (event !== null) {
				events.push(event);
			events.push(finishEvent);
		}
		localStorage.setItem('events', JSON.stringify(events));

		updateCalendar();

		window.location = './menu.html';
	});

	autocomplete = new google.maps.places.Autocomplete(
            /** @type {!HTMLInputElement} */(document.getElementById('event')),
            {types: ['geocode']});

    // When the user selects an address from the dropdown, populate the address
    // fields in the form.
    autocomplete.addListener('place_changed', function(){
		var place = autocomplete.getPlace();
		location = place.geometry.location;
    });
});

function updateCalendar(){
	$('#calendar').fullCalendar('removeEvents');

	var events = JSON.parse(localStorage.getItem('events'));
	if (events == null)
		return false
	events.forEach(function(event){
		$('#calendar').fullCalendar('renderEvent', event, true);
	})
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCCbTdWN0Pe_ji5cWugNvDblRlregC_MSE&libraries=places"></script>
